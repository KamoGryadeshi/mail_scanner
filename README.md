==============================
Mail XLSX Scanner
==============================

Программа для автоматического получения Excel-вложений из непрочитанных писем.

----------------------------------------
Что делает
----------------------------------------

- Подключается к IMAP-серверу
- Проверяет входящие письма (непрочитанные)
- Сохраняет вложения .xlsx в папку attachments
- (Опционально) Загружает данные из файлов в SQLite через pandas

----------------------------------------
Структура проекта
----------------------------------------

mail-xlsx-scanner/
├── main.py               # Точка входа (запускается по расписанию)
├── mail_scanning.py      # Получение писем и сохранение вложений
├── to_db.py              # Импорт данных из Excel в БД
├── .env                  # Переменные окружения (НЕ добавляй в git)
├── attachments/          # Папка для вложений
├── requirements.txt      # Список зависимостей
└── README.txt            # Этот файл

----------------------------------------
Установка и запуск
----------------------------------------

1. Установи зависимости:

   pip install -r requirements.txt

2. Создай файл .env:

   USERNAME=your_email@example.com
   MAIL_PASS=your_password
   IMAP_SERVER=imap.yourmail.com

3. Запусти вручную (для теста):

   python main.py

----------------------------------------
Запуск по расписанию (Windows)
----------------------------------------

1. Открой «Планировщик заданий» (taskschd.msc)
2. Создай новую задачу:
   - Действие: python путь_к_проекту/main.py
   - Триггер: ежедневно в 12:00
   - Общие: запуск от имени пользователя

----------------------------------------
Безопасность
----------------------------------------

- Никогда не коммить .env файл в репозиторий
- Используй .gitignore для защиты паролей

----------------------------------------
Зависимости
----------------------------------------

- imaplib, email (встроенные)
- pandas, openpyxl
- python-dotenv
